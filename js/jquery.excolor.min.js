/*!
 * ExColor for jQuery
 * http://excolor.ramiro.mx/
 */
jQuery.fn.excolor=function(a){var a=jQuery.extend({hue_bar:0,hue_slider:0,sb_slider:0,color_box:!0,demo_mode:!1,show_color_on_border:!1,border_color:"black",sb_border_color:"black",anim_speed:"slow",round_corners:!0,shadow:!0,shadow_size:4,shadow_color:"#8a8a8a",background_color:"silver",backlight:!0,input_text_color:"black",input_background_color:"white",label_color:"black",effect:"none",root_path:!1,rgb_output:!1,callback_on_ok:function(){var a=""}},a);return this.each(function(){function be(){H=jQuery.trim(jQuery(z).val()+""),I="";if(H=="")jQuery(D).val("").css("background","url("+root_path+"transp.gif) repeat"),jQuery(i).find("input").val("");else{if(H.match(J))K=!0,rgbstring=bn(H),I=bo(rgbstring[0],rgbstring[1],rgbstring[2]);else{for(var b=0;b<H.length;b++)H.charAt(b)!="#"&&H.charAt(b)+""in ba&&I.length<6&&(I+=H.charAt(b)+"");switch(I.length){case 0:I="000000"+I;break;case 1:I="00000"+I;break;case 2:I="0000"+I;break;case 3:I="000"+I;break;case 4:I="00"+I;break;case 5:I="0"+I}}H=bl(I),H=bm(H.r,H.g,H.b),l=120-Math.round(H.h*1/3),l<0&&(l=0),l>119&&(l=119),o=H.s,p=H.v,jQuery(D).css("background","#"+I)}a.show_color_on_border&&jQuery(z).css("border-color","#"+I)}function bf(){if(!B)return!1;jQuery(q).remove(),jQuery(n).remove(),jQuery(M).remove(),E=!0;switch(a.effect){case"zoom":jQuery(i).animate({width:"0px",height:"0px"},a.anim_speed,function(){bg(),jQuery(i).remove()});break;case"slide":jQuery(i).slideUp(a.anim_speed,function(){bg(),jQuery(i).remove()});break;case"fade":jQuery(i).fadeTo(a.anim_speed,0,function(){bg(),jQuery(i).remove()});break;default:bg(),jQuery(i).remove()}B=!1}function bg(){if(G){var b="#"+bo(jQuery(s).val()*1,jQuery(t).val()*1,jQuery(u).val()*1),c=jQuery(s).val()*1+","+jQuery(t).val()*1+","+jQuery(u).val()*1;jQuery.trim(jQuery(s).val())==""&&jQuery.trim(jQuery(t).val())==""&&jQuery.trim(jQuery(u).val())==""?(jQuery(D).css("background","url("+root_path+"transp.gif) repeat"),jQuery(z).val("")):(jQuery(D).css("background",b),a.show_color_on_border&&jQuery(z).css("border-color",b),console.log(K),K?jQuery(z).val(c):jQuery(z).val(b)),G=!1,a.callback_on_ok()}}function bh(){var a=bm(jQuery(s).val()*1,jQuery(t).val()*1,jQuery(u).val()*1);l=-1*(Math.round(a.h*1/3)-120),l<0&&(l=0),l>119&&(l=119),o=a.s,p=a.v,jQuery(q).css("left",k.left+"px").css("top",k.top+l+"px"),bp(),bq(),jQuery(v).val(bo(jQuery(s).val()*1,jQuery(t).val()*1,jQuery(u).val()*1))}function bi(){var a=!0,b="";b=jQuery.trim(jQuery(v).val());switch(b.length){case 1:b="00000"+b;break;case 2:b="0000"+b;break;case 3:b="000"+b;break;case 4:b="00"+b;break;case 5:b="0"+b}if(b.length>0)for(var c=0;c<b.length;c++)b.charAt(c)+""in ba||(a=!1);if(a){if(b=="")l=119,o=0,p=0;else{var d=bl(b);jQuery(s).val(d.r),jQuery(t).val(d.g),jQuery(u).val(d.b);var d=bm(d.r,d.g,d.b);l=-1*(Math.round(d.h*1/3)-120),l<0&&(l=0),l>119&&(l=119),o=d.s,p=d.v}jQuery(q).css("left",k.left+"px").css("top",k.top+l+"px"),bp(),bq(),b==""&&(jQuery(r).css("background-image","url("+root_path+"transp.gif)").css("background-repeat","repeat"),jQuery(D).val("").css("background","url("+root_path+"transp.gif) repeat"),jQuery(M).css("background","url("+root_path+"transp0.gif) -20px 0 no-repeat"),jQuery(i).find("input").val(""))}}function bj(){var a=bk(-1*(l-119)*3,o,p,"rgb");jQuery(s).val(Math.round(a.r)*1),jQuery(t).val(Math.round(a.g)*1),jQuery(u).val(Math.round(a.b)*1),jQuery(v).val(bo(a.r,a.g,a.b))}function bk(a,b,c,d){var e=a/360,f=b/100,g=c/100,h=[],i,j,k,l,m,n,o;return f==0?(h.r=g*255,h.g=g*255,h.b=g*255):(i=e*6,j=Math.floor(i),k=g*(1-f),l=g*(1-f*(i-j)),m=g*(1-f*(1-(i-j))),j==0?(n=g,o=m,var_b=k):j==1?(n=l,o=g,var_b=k):j==2?(n=k,o=g,var_b=m):j==3?(n=k,o=l,var_b=g):j==4?(n=m,o=k,var_b=g):(n=g,o=k,var_b=l),h.r=Math.round(n*255),h.g=Math.round(o*255),h.b=Math.round(var_b*255)),d=="hex"?bo(h.r,h.g,h.b):d=="rgb"?h:h}function bl(a){var b=new String;b=a,b.toUpperCase(),a=b;var c,d="0123456789ABCDEF",e="",f=[];if(a){a=a.toUpperCase();for(c=0;c<6;c+=2)switch(c){case 0:f.r=(16*d.indexOf(a.charAt(c))+d.indexOf(a.charAt(c+1)))*1;break;case 2:f.g=(16*d.indexOf(a.charAt(c))+d.indexOf(a.charAt(c+1)))*1;break;case 4:f.b=(16*d.indexOf(a.charAt(c))+d.indexOf(a.charAt(c+1)))*1}}return f}function bm(a,b,c){var d=0,e=0,f=0,g=0,h=0,i=0,j=[];return g=0,d=Math.min(Math.min(a,b),c),e=Math.max(Math.max(a,b),c),f=e-d,i=e,e!=0?h=255*f/e:h=0,h!=0?a==e?g=(b-c)/f:b==e?g=2+(c-a)/f:c==e&&(g=4+(a-b)/f):g=-1,g=g*60,g<0&&(g=g+360),j.h=Math.round(g),j.s=Math.round(h*100/255),j.v=Math.round(i*100/255),j.h>360&&(j.h=360),j.s>100&&(j.s=100),j.v>100&&(j.v=100),j}function bn(a){return array=a.split(","),array}function bo(a,b,c){var d=[];d[0]=a,d[1]=b,d[2]=c;var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],f="";for(var g=0;g<d.length;g++)dec=parseInt(d[g]),f+=e[parseInt(dec/16)]+e[dec%16];return f}function bp(){jQuery(q).css("left",k.left+"px").css("top",k.top+l+"px"),jQuery(n).css("left",pos_sbbox.left+Math.round(o*1.3)-4+"px").css("top",pos_sbbox.top+jQuery(m).height()-4-Math.round(p*1.3)+"px")}function bq(){jQuery(m).css("background-color","#"+bk(-1*(l-119)*3,100,100,"hex")),jQuery(r).css("background-color","#"+bk(-1*(l-119)*3,o,p,"hex")).css("background-image","none"),jQuery(M).css("background","url("+root_path+"transp0.gif) 0 0 no-repeat")}function br(){var D=-1*a.hue_bar*20,H='<div id="excolor_sample_wrapper"><div id="excolor_sample"></div></div>';be(),jQuery("body").append('<div id="excolor_colorpicker"><div id="excolor_colorpicker_wrapper"><div id="excolor_grad_wrap"><div id="excolor_grad"><div style="width:130px;height:130px;float:left;background-image:url('+root_path+'bg.png);background-position:0 0;background-repeat:no-repeat;border:1px solid white;padding:0;margin:0;"></div></div></div><div id="excolor_hue_wrap" style="width:20px;height:130px;float:left;padding:15px 8px 0px 10px;margin:0;border:none;"><div id="excolor_hue" style="width:20px;height:130px;float:left;background:url('+root_path+"hue.png) "+D+'px 0 no-repeat;margin:0;padding:0;border:none;"></div></div><div id="excolor_data" style="float:left;font-size:10px;font-family: Verdana, Arial, Helvetica, Sans-serif;width:66px;height:140px;margin:0;padding:0;border:none;">'+H+'<div class="excolor_dataitem first"><b class="label">R</b><input id="excolor_r" class="excolor_input excolor_rgb" type="text" size="3" maxlength="3" /></div><div class="excolor_dataitem" style="float:left;padding:3px 0 0 0;margin:0;border:none;"><b class="label">G</b><input id="excolor_g" class="excolor_input excolor_rgb" type="text" size="3" maxlength="3" /></div><div class="excolor_dataitem"><b class="label">B</b><input id="excolor_b" class="excolor_input excolor_rgb" type="text" size="3" maxlength="3" /></div><div class="excolor_dataitem last"><b class="label">#</b><input id="excolor_hex" class="excolor_input" type="text" size="6" maxlength="6" /></div><div style="width:66px;height:15px;padding:0;margin:0;border:none;float:left;"><div id="excolor_ok">OK</div><div id="excolor_close">X</div></div></div></div></div><div id="excolor_picker"></div><div id="excolor_slider"></div><div id="excolor_switcher"></div>'),A=jQuery(z).offset(),i=jQuery("body > div#excolor_colorpicker").css("left",A.left+"px").css("top",A.top+jQuery(z).outerHeight()+"px").mouseenter(function(){clearTimeout(F),F=setTimeout(function(){E=!0},50)}).mouseleave(function(){clearTimeout(F),F=setTimeout(function(){E=!1},50)}),v=jQuery(i).find("input#excolor_hex"),M=jQuery("body > div#excolor_switcher"),q=jQuery("body > div#excolor_slider"),n=jQuery("body > div#excolor_picker");switch(a.effect){case"zoom":jQuery(i).css("width","0px").css("height","0px").show().animate({width:"265px",height:"162px"},a.anim_speed,function(){jQuery(this).show(),jQuery("body > div#excolor_slider, body > div#excolor_picker").show(),jQuery(M).show()});break;case"slide":jQuery(i).slideDown(a.anim_speed,function(){jQuery(this).show(),jQuery("body > div#excolor_slider, body > div#excolor_picker").show(),jQuery(M).show()});break;case"fade":jQuery("body > div#excolor_colorpicker, body > div#excolor_slider, body > div#excolor_picker, body > div#excolor_switcher").fadeTo(1,0,function(){jQuery(this).show().fadeTo(a.anim_speed,1)});break;default:jQuery(i).show(),jQuery(M).show(),jQuery("body > div#excolor_slider, body > div#excolor_picker").show()}h=jQuery(i).find("div#excolor_hue"),m=jQuery(i).find("div#excolor_grad div"),r=jQuery(i).find("#excolor_sample"),s=jQuery(i).find("input#excolor_r"),t=jQuery(i).find("input#excolor_g"),u=jQuery(i).find("input#excolor_b"),x=jQuery(i).find("#excolor_ok"),y=jQuery(i).find("#excolor_close"),j=jQuery(i).offset(),pos_sbbox=jQuery(m).offset(),k=jQuery(h).offset(),jQuery(M).click(function(){jQuery.trim(jQuery(s).val())==""&&jQuery.trim(jQuery(t).val())==""&&jQuery.trim(jQuery(u).val())==""?(jQuery(r).css("background-image","none"),jQuery(this).css("background","url("+root_path+"transp0.gif) 0 0 no-repeat"),bj()):(jQuery(r).css("background-image","url("+root_path+"transp.gif)").css("background-repeat","repeat"),jQuery(i).find("input").val(""),jQuery(this).css("background","url("+root_path+"transp0.gif) -20px 0 no-repeat"))}).css("left",k.left-1+"px").css("top",k.top-15+"px").mouseenter(function(){clearTimeout(F),F=setTimeout(function(){E=!0},50)}).mouseleave(function(){clearTimeout(F),F=setTimeout(function(){E=!1},50)}),jQuery(q).mouseenter(function(){clearTimeout(F),F=setTimeout(function(){E=!0},50)}).mouseleave(function(){clearTimeout(F),F=setTimeout(function(){E=!1},50)}),jQuery(n).mouseenter(function(){clearTimeout(F),F=setTimeout(function(){E=!0},50)}).mouseleave(function(){clearTimeout(F),F=setTimeout(function(){E=!1},50)}).dblclick(function(a){jQuery(x).click()}),jQuery(n).mousedown(function(a){f=jQuery(this).offset(),d=a.pageX-f.left,e=a.pageY-f.top,b=this,jQuery(M).css("background","url("+root_path+"transp0.gif) 0 0 no-repeat"),a.preventDefault()}).click(function(a){}),jQuery(q).mousedown(function(a){g=jQuery(this).offset(),d=a.pageX-g.left,e=a.pageY-g.top,c=this,jQuery(M).css("background","url("+root_path+"transp0.gif) 0 0 no-repeat"),a.preventDefault()}),jQuery(h).mousedown(function(a){a.pageY>=k.top+5&&a.pageY<=k.top+jQuery(h).height()-6&&(l=a.pageY-k.top-5,l<0&&(l=0),l>119&&(l=119),jQuery(M).css("background","url("+root_path+"transp0.gif) 0 0 no-repeat"),bp(),bq(),bj(),g=jQuery(q).offset(),d=a.pageX-g.left,e=a.pageY-g.top,c=q,a.preventDefault())}),jQuery(m).mousedown(function(a){o=Math.round((a.pageX-pos_sbbox.left-1)/1.3),o>100&&(o=100),o<1&&(o=1),p=-1*(Math.round((a.pageY-pos_sbbox.top-1)/1.3)-100),p>100&&(p=100),p<1&&(p=1),jQuery(M).css("background","url("+root_path+"transp0.gif) 0 0 no-repeat"),bp(),jQuery(r).css("background-color","#"+bk(-1*(l-119)*3,o,p,"hex")).css("background-image","none"),bj(),b=n,f=jQuery(b).offset(),d=a.pageX-f.left,e=a.pageY-f.top,a.preventDefault()}),jQuery(i).find("input.excolor_input").keypress(function(a){jQuery(this).hasClass("excolor_rgb")?!(String.fromCharCode(a.which)*1 in _)&&!(a.which in bb)&&a.preventDefault():!(String.fromCharCode(a.which)in ba)&&!(a.which in bb)&&a.preventDefault()}).change(function(){jQuery(this).hasClass("excolor_rgb")?(jQuery(this).val()==""&&jQuery(this).val("0"),isNaN(jQuery(this).val()*1)&&jQuery(this).val("0"),jQuery(this).val()*1>255&&jQuery(this).val("255"),jQuery(this).val()*1<0&&jQuery(this).val("0"),bh()):bi()}).keyup(function(){jQuery(this).hasClass("excolor_rgb")?(jQuery(this).val()==""&&jQuery(this).val("0"),isNaN(jQuery(this).val()*1)&&jQuery(this).val("0"),jQuery(this).val()*1>255&&jQuery(this).val("255"),jQuery(this).val()*1<0&&jQuery(this).val("0"),bh()):bi()}),v[0].onpaste=v[0].oninput=function(a){clearTimeout(w),w=setTimeout(function(){bi()},100)},s[0].onpaste=s[0].oninput=t[0].onpaste=t[0].oninput=u[0].onpaste=u[0].oninput=function(a){jQuery(this).val()==""&&jQuery(this).val("0"),isNaN(jQuery(this).val()*1)&&jQuery(this).val("0"),jQuery(this).val()*1>255&&jQuery(this).val("255"),jQuery(this).val()*1<0&&jQuery(this).val("0"),clearTimeout(w),w=setTimeout(function(){bh()},100)},jQuery(x).click(function(){G=!0,bf()}).mouseenter(function(){jQuery(this).css("background-position","0 -15px")}).mouseleave(function(){jQuery(this).css("background-position","0 0")}),jQuery(y).click(function(){bf()}).mouseenter(function(){jQuery(this).css("background-position","-47px -15px")}).mouseleave(function(){jQuery(this).css("background-position","-47px 0")}),bp(),jQuery(v).val(I),bi(),B=!0,I==""?jQuery(M).css("background","url("+root_path+"transp0.gif) -20px 0 no-repeat"):jQuery(M).css("background","url("+root_path+"transp0.gif) 0 0 no-repeat")}var b="mel",c="mel",d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=1,p=1,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=this,A=jQuery(this).offset(),B=!1,D=0,E=0,F=0,G=!1,H="",I="",J=/\d+\,\d+\,\d+/i,K=a.rgb_output,L=0,M=0;c=jQuery("script");if(!a.root_path)for(var N=0;N<c.length;N++)b=""+jQuery(c[N]).attr("src"),b=b.toLowerCase(),b=b.split("jquery.excolor.js"),b.length==2&&(root_path=b[0],console.log(root_path));else root_path=a.root_path;var O=new Image,P=new Image,Q=new Image,R=new Image,S=new Image,T=new Image,U=new Image,V=new Image;O.src=root_path+"sel.gif",P.src=root_path+"slider.gif",Q.src=root_path+"bg.png",R.src=root_path+"hue.png",S.src=root_path+"ok.png",T.src=root_path+"shbg.png",U.src=root_path+"transp0.gif",V.src=root_path+"transp.gif",c="mel",b="mel",jQuery(z).mouseenter(function(){clearTimeout(F),F=setTimeout(function(){E=!0},100)}).mouseleave(function(){clearTimeout(F),F=setTimeout(function(){E=!1},100)}),a.color_box&&jQuery(z).wrap('<span style="margin:0;padding:0 '+jQuery(z).outerHeight()+'px 0 0;display:inline-block;border:none;background:none;line-height:auto;"></span>');var W="",X="",Y="",Z="",$="";a.round_corners&&(W="-khtml-border-radius:2px;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;",X="-khtml-border-radius:2px;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;",Y="-khtml-border-radius: 0 2px 2px 2px;-moz-border-radius: 0 2px 2px 2px;-webkit-border-radius: 0 2px 2px 2px;border-radius: 0 2px 2px 2px;"),a.shadow&&(Z="box-shadow:0 "+a.shadow_size+"px "+a.shadow_size*2+"px 0 "+a.shadow_color+";-webkit-box-shadow:0 "+a.shadow_size+"px "+a.shadow_size*2+"px 0 "+a.shadow_color+";-moz-box-shadow:0 "+a.shadow_size+"px "+a.shadow_size*2+"px 0 "+a.shadow_color+";"),a.backlight&&($="background-position:0 0;background-repeat:no-repeat;background-image:url("+root_path+"shbg.png);");var _=[0,1,2,3,4,5,6,7,8,9];_[8]=8,_[46]=46;var ba=[];ba[0]=1,ba[1]=1,ba[2]=1,ba[3]=1,ba[4]=1,ba[5]=1,ba[6]=1,ba[7]=1,ba[8]=1,ba[9]=1,ba.A=1,ba.B=1,ba.C=1,ba.D=1,ba.E=1,ba.F=1,ba.a=1,ba.b=1,ba.c=1,ba.d=1,ba.e=1,ba.f=1;var bb=[];bb[0]="system keys",bb[8]="backspace",bb[118]="ctrl v",bb[86]="ctrl v",bb[99]="ctrl c",bb[67]="ctrl c";var bc=" "+Math.random();bc=bc.split("."),bc="mc"+bc[1];var bd=jQuery(z).parent().offset();jQuery(z).parent().append('&nbsp;<input class="excolor_clrbox" readonly="readonly" id="'+bc+'" type="text" style="display:none;cursor:pointer;width:'+(jQuery(z).outerHeight()-4)+"px;height:"+(jQuery(z).outerHeight()-4)+"px;background:none;"+X+"border:1px solid "+a.border_color+';" />'),jQuery(z).clone().show().addClass("mds"+bc).css("position","absolute").css("visibility","hidden").appendTo("body"),setTimeout(function(){var a=jQuery("body > .mds"+bc);jQuery(z).parent().find("#"+bc).css("width",jQuery(a).outerHeight()-2+"px"),jQuery(a).remove()},300),D=jQuery(z).parent().find("#"+bc).mouseenter(function(){clearTimeout(F),F=setTimeout(function(){E=!0},50)}).mouseleave(function(){clearTimeout(F),F=setTimeout(function(){E=!1},50)}).focus(function(){jQuery(z).focus()}),a.color_box&&setTimeout(function(){jQuery(D).show()},150),be(),setTimeout(function(){A=jQuery(z).offset()},200),jQuery(document).mouseup(function(a){b="mel",c="mel"}).mousemove(function(a){if(b!="mel"){a.preventDefault();var f=0,g=0;f=a.pageX-d,f<pos_sbbox.left-4&&(f=pos_sbbox.left-4),f>pos_sbbox.left+125&&(f=pos_sbbox.left+125),g=a.pageY-e,g<pos_sbbox.top-4&&(g=pos_sbbox.top-4),g>pos_sbbox.top+125&&(g=pos_sbbox.top+125),jQuery(b).css("left",f+"px").css("top",g+"px"),p=-1*(Math.round((g-pos_sbbox.top+5)/1.3)-100)+1,o=Math.round((f-pos_sbbox.left+5)/1.3),p==1&&(p=0),o==1&&(o=0),jQuery(r).css("background-color","#"+bk(-1*(l-119)*3,o,p,"hex")).css("background-image","none"),bj()}c!="mel"&&(a.preventDefault(),l=a.pageY-k.top-e,l<0&&(l=0),l>119&&(l=119),jQuery(c).css("left",k.left+"px").css("top",k.top+l+"px"),bq(),bj())}).keydown(function(a){a.keyCode=="27"&&(a.preventDefault(),bf()),a.keyCode=="13"&&(a.preventDefault(),jQuery(x).click())}).click(function(){E||bf()}),jQuery(z).click(function(){B||(jQuery("body > div#excolor_slider, body > div#excolor_picker, body > div#excolor_colorpicker").stop().remove(),setTimeout(function(){br()},50))}).keyup(function(){B&&(be(),bj(),bp(),jQuery(v).val(I),bi())}),jQuery(D).click(function(){jQuery(z).click()}),a.demo_mode&&jQuery(D).click()})}